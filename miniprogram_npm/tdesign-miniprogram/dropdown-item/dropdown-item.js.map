{"version":3,"sources":["../../src/dropdown-item/dropdown-item.ts"],"names":[],"mappings":"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","file":"dropdown-item.js","sourcesContent":["import { RelationsOptions, SuperComponent, wxComponent } from '../common/src/index';\nimport config from '../common/config';\nimport props from './props';\nimport menuProps from '../dropdown-menu/props';\nimport type { TdDropdownItemProps } from './type';\nimport { getRect } from '../common/utils';\n\nconst { prefix } = config;\nconst name = `${prefix}-dropdown-item`;\n\nexport interface DropdownItemProps extends TdDropdownItemProps {}\n@wxComponent()\nexport default class DropdownMenuItem extends SuperComponent {\n  externalClasses = [\n    `${prefix}-class`,\n    `${prefix}-class-content`,\n    `${prefix}-class-column`,\n    `${prefix}-class-column-item`,\n    `${prefix}-class-column-item-label`,\n    `${prefix}-class-footer`,\n  ];\n\n  properties = {\n    ...props,\n  };\n\n  data = {\n    prefix,\n    classPrefix: name,\n    show: false,\n    top: 0,\n    maskHeight: 0,\n    initValue: null,\n    hasChanged: false,\n    duration: menuProps.duration.value,\n    zIndex: menuProps.zIndex.value,\n    overlay: menuProps.showOverlay.value,\n    labelAlias: 'label',\n    valueAlias: 'value',\n  };\n\n  parent = null;\n\n  relations: RelationsOptions = {\n    '../dropdown-menu/dropdown-menu': {\n      type: 'parent',\n      linked(target) {\n        const { zIndex, duration, showOverlay } = target.properties;\n\n        this.parent = target;\n        this.setData({\n          zIndex,\n          duration,\n          showOverlay,\n        });\n      },\n    },\n  };\n\n  controlledProps = [\n    {\n      key: 'value',\n      event: 'change',\n    },\n  ];\n\n  observers = {\n    keys(obj) {\n      this.setData({\n        labelAlias: obj.label || 'label',\n        valueAlias: obj.value || 'value',\n      });\n    },\n    value(v) {\n      const { options, labelAlias, valueAlias } = this.data;\n\n      if (this.data.multiple) {\n        if (!Array.isArray(v)) throw TypeError('应传入数组类型的 value');\n      }\n\n      const target = options.find((item) => item[valueAlias] === v);\n\n      if (target) {\n        this.setData({\n          label: target[labelAlias],\n        });\n      }\n    },\n    label() {\n      this.parent?.getAllItems();\n    },\n    show(visible) {\n      if (visible) {\n        this.getParentBottom(this.parent, () => {\n          this.setData({ wrapperVisible: true });\n        });\n      }\n    },\n  };\n\n  methods = {\n    closeDropdown() {\n      this.parent?.setData({\n        activeIdx: -1,\n      });\n      this.setData({\n        show: false,\n      });\n    },\n\n    getParentBottom(parent, cb) {\n      getRect(parent, `#${prefix}-bar`).then((rect) => {\n        this.setData(\n          {\n            top: rect.bottom,\n            maskHeight: rect.top,\n          },\n          cb,\n        );\n      });\n    },\n\n    handleTreeClick(e) {\n      const { level, value: itemValue } = e.currentTarget.dataset;\n      const { value } = this.data;\n\n      value[level] = itemValue;\n      this._trigger('change', { value });\n    },\n\n    handleRadioChange(e) {\n      const { value } = e.detail;\n\n      this._trigger('change', { value });\n\n      if (!this.data.multiple) {\n        this.closeDropdown();\n      }\n    },\n\n    handleMaskClick() {\n      if (this.parent?.properties.closeOnClickOverlay) {\n        this.closeDropdown();\n      }\n    },\n\n    handleReset() {\n      this._trigger('change', { value: [] });\n    },\n\n    handleConfirm() {\n      this._trigger('confirm', { value: this.data.value });\n      this.closeDropdown();\n    },\n\n    onLeaved() {\n      this.setData({ wrapperVisible: false });\n    },\n  };\n}\n"]}