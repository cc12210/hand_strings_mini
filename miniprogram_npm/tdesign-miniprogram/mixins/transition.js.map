{"version":3,"sources":["../../src/mixins/transition.ts"],"names":[],"mappings":"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","file":"transition.js","sourcesContent":["import config from '../common/config';\n\nconst { prefix } = config;\n\nexport default function transition() {\n  return Behavior({\n    properties: {\n      visible: {\n        type: Boolean,\n        value: null,\n        observer: 'watchVisible',\n      },\n      appear: Boolean,\n      name: {\n        type: String,\n        value: 'fade',\n      },\n      durations: {\n        type: Number,\n        optionalTypes: [Array],\n      },\n    },\n\n    data: {\n      transitionClass: '',\n      transitionDurations: 300,\n      className: '',\n      realVisible: false,\n    },\n\n    created() {\n      this.status = '';\n      this.transitionT = 0;\n    },\n    attached() {\n      this.durations = this.getDurations();\n      if (this.data.visible) {\n        this.enter();\n      }\n      this.inited = true;\n    },\n    detached() {\n      clearTimeout(this.transitionT);\n    },\n\n    methods: {\n      watchVisible(curr, prev) {\n        if (this.inited && curr !== prev) {\n          curr ? this.enter() : this.leave();\n        }\n      },\n      getDurations() {\n        const { durations } = this.data;\n        if (Array.isArray(durations)) {\n          return durations.map((item) => Number(item));\n        }\n        return [Number(durations), Number(durations)];\n      },\n      enter() {\n        const { name } = this.data;\n        const [duration] = this.durations;\n        this.status = 'entering';\n        this.setData({\n          realVisible: true,\n          transitionClass: `${prefix}-${name}-enter ${prefix}-${name}-enter-active`,\n        });\n        setTimeout(() => {\n          this.setData({\n            transitionClass: `${prefix}-${name}-enter-active ${prefix}-${name}-enter-to`,\n          });\n        }, 30);\n        if (typeof duration === 'number' && duration > 0) {\n          this.transitionT = setTimeout(this.entered.bind(this), duration + 30);\n        }\n      },\n      entered() {\n        this.customDuration = false;\n        clearTimeout(this.transitionT);\n        this.status = 'entered';\n        this.setData({\n          transitionClass: '',\n        });\n      },\n      leave() {\n        const { name } = this.data;\n        const [, duration] = this.durations;\n        this.status = 'leaving';\n        this.setData({\n          transitionClass: `${prefix}-${name}-leave  ${prefix}-${name}-leave-active`,\n        });\n        clearTimeout(this.transitionT);\n        setTimeout(() => {\n          this.setData({\n            transitionClass: `${prefix}-${name}-leave-active ${prefix}-${name}-leave-to`,\n          });\n        }, 30);\n        if (typeof duration === 'number' && duration > 0) {\n          this.customDuration = true;\n          this.transitionT = setTimeout(this.leaved.bind(this), duration + 30);\n        }\n      },\n      leaved() {\n        this.customDuration = false;\n        this.triggerEvent('leaved');\n        clearTimeout(this.transitionT);\n        this.status = 'leaved';\n        this.setData({\n          transitionClass: '',\n        });\n      },\n      onTransitionEnd() {\n        if (this.customDuration) {\n          return;\n        }\n\n        clearTimeout(this.transitionT);\n        if (this.status === 'entering' && this.data.visible) {\n          this.entered();\n        } else if (this.status === 'leaving' && !this.data.visible) {\n          this.leaved();\n          this.setData({\n            realVisible: false,\n          });\n        }\n      },\n    },\n  });\n}\n"]}