{"version":3,"sources":["../../src/mixins/page-scroll.ts"],"names":[],"mappings":";;AAEA,aAAK,iBAAiB,GAAG,iBAAiB,CAAC,IAAI,CAAC,iBAAiB,CAAC;AAClE,aAAK,QAAQ,GAAG,CAAC,IAAI,EAAE,iBAAiB,CAAC,SAAS,CAAC,eAAe,EAAE,KAAK,CAAC,EAAE,iBAAiB,KAAK,IAAI,CAAC;mCAkB7E,QAAQ;AAAlC,wBAuBE","file":"page-scroll.d.ts","sourcesContent":["import { getCurrentPage } from '../common/utils';\n\ntype IPageScrollOption = WechatMiniprogram.Page.IPageScrollOption;\ntype Scroller = (this: WechatMiniprogram.Component.TrivialInstance, event?: IPageScrollOption) => void;\n\nconst onPageScroll = function (event?: IPageScrollOption) {\n  const page = getCurrentPage<{\n    pageScroller: Scroller[];\n  }>();\n\n  if (!page) return;\n  const { pageScroller } = page;\n\n  pageScroller.forEach((scroller: Scroller) => {\n    if (typeof scroller === 'function') {\n      // @ts-ignore\n      scroller(event);\n    }\n  });\n};\n\nexport default (scroller: Scroller) => {\n  return Behavior({\n    attached() {\n      const page = getCurrentPage<{ pageScroller: Scroller[] }>();\n      if (!page) return;\n      const bindScroller = scroller.bind(this);\n\n      if (Array.isArray(page.pageScroller)) {\n        page.pageScroller.push(bindScroller);\n      } else {\n        page.pageScroller =\n          typeof page.onPageScroll === 'function' ? [page.onPageScroll.bind(page), bindScroller] : [bindScroller];\n      }\n\n      page.onPageScroll = onPageScroll;\n    },\n\n    detached() {\n      const page = getCurrentPage<{ pageScroller: Scroller[] }>();\n      if (!page) return;\n      page.pageScroller = page.pageScroller?.filter((item) => item !== scroller) || [];\n    },\n  });\n};\n"]}