{"version":3,"sources":["../../src/collapse/collapse.ts"],"names":[],"mappings":";;;;;;AAAA,OAAO,EAAE,cAAc,EAAE,WAAW,EAAoB,MAAM,qBAAqB,CAAC;AACpF,OAAO,MAAM,MAAM,kBAAkB,CAAC;AACtC,OAAO,KAAK,MAAM,SAAS,CAAC;AAG5B,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,CAAC;AAC1B,MAAM,IAAI,GAAG,GAAG,MAAM,WAAW,CAAC;AAKlC,IAAqB,QAAQ,GAA7B,MAAqB,QAAS,SAAQ,cAAc;IAApD;;QACE,YAAO,GAAG;YACR,cAAc,EAAE,IAAI;SACrB,CAAC;QAEF,oBAAe,GAAG,CAAC,GAAG,MAAM,QAAQ,CAAC,CAAC;QAEtC,cAAS,GAAqB;YAC5B,kCAAkC,EAAE;gBAClC,IAAI,EAAE,YAAY;gBAClB,MAAM;oBACJ,IAAI,CAAC,cAAc,EAAE,CAAC;gBACxB,CAAC;aACF;SACF,CAAC;QAEF,oBAAe,GAAG;YAChB;gBACE,GAAG,EAAE,OAAO;gBACZ,KAAK,EAAE,QAAQ;aAChB;SACF,CAAC;QAEF,eAAU,GAAG,KAAK,CAAC;QAEnB,SAAI,GAAG;YACL,MAAM;YACN,WAAW,EAAE,IAAI;SAClB,CAAC;QAEF,cAAS,GAAG;YACV,qBAAqB;gBACnB,IAAI,CAAC,cAAc,EAAE,CAAC;YACxB,CAAC;SACF,CAAC;QAEF,YAAO,GAAG;YACR,cAAc;gBACZ,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,KAAkD,EAAE,EAAE;oBAC5E,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;gBAC9C,CAAC,CAAC,CAAC;YACL,CAAC;YAED,MAAM,CAAC,UAAyB;gBAC9B,MAAM,EAAE,WAAW,EAAE,KAAK,EAAE,YAAY,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC;gBAC7D,IAAI,KAAK,GAAG,EAAE,CAAC;gBACf,MAAM,GAAG,GAAG,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;gBAE7C,IAAI,GAAG,GAAG,CAAC,CAAC,EAAE;oBACZ,KAAK,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,KAAK,UAAU,CAAC,CAAC;iBAC5D;qBAAM;oBACL,KAAK,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;iBACtE;gBAED,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,EAAE,KAAK,EAAE,CAAC,CAAC;YACrC,CAAC;SACF,CAAC;IACJ,CAAC;CAAA,CAAA;AAzDoB,QAAQ;IAD5B,WAAW,EAAE;GACO,QAAQ,CAyD5B;eAzDoB,QAAQ","file":"collapse.js","sourcesContent":["import { SuperComponent, wxComponent, RelationsOptions } from '../common/src/index';\nimport config from '../common/config';\nimport props from './props';\nimport type { CollapseValue, TdCollapseProps } from './type';\n\nconst { prefix } = config;\nconst name = `${prefix}-collapse`;\n\nexport interface CollapseProps extends TdCollapseProps {}\n\n@wxComponent()\nexport default class Collapse extends SuperComponent {\n  options = {\n    addGlobalClass: true,\n  };\n\n  externalClasses = [`${prefix}-class`];\n\n  relations: RelationsOptions = {\n    '../collapse-panel/collapse-panel': {\n      type: 'descendant',\n      linked() {\n        this.updateExpanded();\n      },\n    },\n  };\n\n  controlledProps = [\n    {\n      key: 'value',\n      event: 'change',\n    },\n  ];\n\n  properties = props;\n\n  data = {\n    prefix,\n    classPrefix: name,\n  };\n\n  observers = {\n    'value, expandMutex '() {\n      this.updateExpanded();\n    },\n  };\n\n  methods = {\n    updateExpanded() {\n      this.$children.forEach((child: WechatMiniprogram.Component.TrivialInstance) => {\n        child.updateExpanded(this.properties.value);\n      });\n    },\n\n    switch(panelValue: CollapseValue) {\n      const { expandMutex, value: activeValues } = this.properties;\n      let value = [];\n      const hit = activeValues.indexOf(panelValue);\n\n      if (hit > -1) {\n        value = activeValues.filter((item) => item !== panelValue);\n      } else {\n        value = expandMutex ? [panelValue] : activeValues.concat(panelValue);\n      }\n\n      this._trigger('change', { value });\n    },\n  };\n}\n"]}