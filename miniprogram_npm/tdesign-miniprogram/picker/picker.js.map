{"version":3,"sources":["../../src/picker/picker.ts"],"names":[],"mappings":"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","file":"picker.js","sourcesContent":["import { SuperComponent, wxComponent, RelationsOptions } from '../common/src/index';\nimport config from '../common/config';\nimport props from './props';\n\nconst { prefix } = config;\nconst name = `${prefix}-picker`;\n\n@wxComponent()\nexport default class Picker extends SuperComponent {\n  properties = props;\n\n  externalClasses = [`${prefix}-class`, `${prefix}-class-confirm`, `${prefix}-class-cancel`, `${prefix}-class-title`];\n\n  options = {\n    multipleSlots: true,\n  };\n\n  relations: RelationsOptions = {\n    '../picker-item/picker-item': {\n      type: 'child',\n      linked(this: Picker) {\n        this.updateChildren();\n      },\n    },\n  };\n\n  observers = {\n    value() {\n      this.updateChildren();\n    },\n  };\n\n  data = {\n    prefix,\n    classPrefix: name,\n  };\n\n  methods = {\n    updateChildren() {\n      const { value } = this.properties;\n\n      this.$children.forEach((child, index) => {\n        child.setData({\n          value: value?.[index] || '',\n          siblingCount: this.$children.length,\n        });\n        child.update();\n      });\n    },\n\n    getSelectedValue() {\n      const value = this.$children.map((item) => item._selectedValue);\n      const label = this.$children.map((item) => item._selectedLabel);\n      return [value, label];\n    },\n\n    getColumnIndexes() {\n      const columns = this.$children.map((pickerColumn, columnIndex) => {\n        return {\n          column: columnIndex,\n          index: pickerColumn._selectedIndex,\n        };\n      });\n      return columns;\n    },\n\n    onConfirm() {\n      const [value, label] = this.getSelectedValue();\n      const columns = this.getColumnIndexes();\n\n      this.close();\n      this.triggerEvent('change', { value, label, columns });\n      this.triggerEvent('confirm', { value, label, columns });\n    },\n\n    triggerColumnChange({ column, index }) {\n      const [value, label] = this.getSelectedValue();\n      this.triggerEvent('pick', { value, label, column, index });\n    },\n\n    onCancel() {\n      this.close();\n      this.triggerEvent('cancel');\n    },\n\n    onPopupChange(e) {\n      const { visible } = e.detail;\n\n      this.close();\n      this.triggerEvent('visible-change', { visible });\n    },\n\n    close() {\n      if (this.data.autoClose) {\n        this.setData({ visible: false });\n      }\n    },\n  };\n\n  ready() {\n    this.$children.map((column, index) => (column.columnIndex = index));\n  }\n}\n"]}