{"version":3,"sources":["../../src/navbar/navbar.ts"],"names":[],"mappings":"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","file":"navbar.js","sourcesContent":["import { SuperComponent, wxComponent } from '../common/src/index';\nimport config from '../common/config';\nimport props from './props';\n\nconst { prefix } = config;\nconst name = `${prefix}-navbar`;\n\n@wxComponent()\nexport default class Navbar extends SuperComponent {\n  externalClasses = [\n    `${prefix}-class`,\n    `${prefix}-class-title`,\n    `${prefix}-class-left`,\n    `${prefix}-class-center`,\n    `${prefix}-class-left-icon`,\n    `${prefix}-class-home-icon`,\n    `${prefix}-class-capsule`,\n    `${prefix}-class-nav-btn`,\n  ];\n\n  timer = null;\n\n  options = {\n    addGlobalClass: true,\n    multipleSlots: true,\n  };\n\n  properties = props;\n\n  observers = {\n    visible(this: Navbar, visible) {\n      const { animation } = this.properties;\n      const visibleClass = `${name}${visible ? '--visible' : '--hide'}`;\n      this.setData({\n        visibleClass: `${visibleClass}${animation ? '-animation' : ''}`,\n      });\n      if (this.timer) {\n        clearTimeout(this.timer);\n      }\n      if (animation) {\n        this.timer = setTimeout(() => {\n          this.setData({\n            visibleClass,\n          });\n        }, 300);\n      }\n    },\n    'title,titleMaxLength'(this: any) {\n      const { title } = this.properties;\n      const titleMaxLength = this.properties.titleMaxLength || Number.MAX_SAFE_INTEGER;\n      let temp = title.slice(0, titleMaxLength);\n      if (titleMaxLength < title.length) temp += '...';\n      this.setData({\n        showTitle: temp,\n      });\n    },\n  };\n\n  data = {\n    prefix,\n    classPrefix: name,\n    boxStyle: '',\n    showTitle: '',\n  };\n\n  attached() {\n    // 场景值为1177（视频号直播间）和1175 （视频号profile页）时，小程序禁用了 wx.getMenuButtonBoundingClientRect\n    let rect = null;\n    if (wx.getMenuButtonBoundingClientRect) {\n      rect = wx.getMenuButtonBoundingClientRect();\n    }\n    if (!rect) return;\n    wx.getSystemInfo({\n      success: (res) => {\n        const boxStyleList = [];\n        const { statusBarHeight } = wx.getSystemInfoSync();\n\n        boxStyleList.push(`--td-navbar-padding-top:${statusBarHeight}px`);\n        if (rect && res?.windowWidth) {\n          boxStyleList.push(`--td-navbar-right:${res.windowWidth - rect.left}px`); // 导航栏右侧小程序胶囊按钮宽度\n        }\n        boxStyleList.push(`--td-navbar-capsule-height: ${rect.height}px`); // 胶囊高度\n        boxStyleList.push(`--td-navbar-capsule-width:${rect.width}px`); // 胶囊宽度\n        this.setData({\n          boxStyle: `${boxStyleList.join('; ')}`,\n        });\n      },\n      fail: (err) => {\n        console.error('navbar 获取系统信息失败', err);\n      },\n    });\n  }\n\n  methods = {\n    goBack() {\n      const { delta } = this.data;\n      // eslint-disable-next-line\n      const that = this;\n      this.triggerEvent('go-back');\n      if (delta > 0) {\n        wx.navigateBack({\n          delta,\n          fail(e) {\n            that.triggerEvent('fail', e);\n          },\n          complete(e) {\n            that.triggerEvent('complete', e);\n          },\n          success(e) {\n            that.triggerEvent('success', e);\n          },\n        });\n      }\n    },\n  };\n}\n"]}