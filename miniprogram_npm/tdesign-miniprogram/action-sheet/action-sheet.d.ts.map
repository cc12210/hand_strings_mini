{"version":3,"sources":["../../src/action-sheet/action-sheet.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,cAAc,EAAe,MAAM,qBAAqB,CAAC;AASlE,MAAM,CAAC,OAAO,OAAO,WAAY,SAAQ,cAAc;IACrD,MAAM,CAAC,IAAI,mGAAQ;IAEnB,eAAe,WAA4E;IAE3F,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAER;IAEF,IAAI;;;;;MAKF;IAEF,eAAe;;;QAKb;IAEF,KAAK;IAKL,OAAO;0BACa,4BAA4B;;QAgB9C,aAAa;;;QAmBb,aAAa;;QAKb,eAAe;;;;wBAWC,4BAA4B;;MAe5C;CACH","file":"action-sheet.d.ts","sourcesContent":["import { chunk } from '../common/utils';\nimport { SuperComponent, wxComponent } from '../common/src/index';\nimport config from '../common/config';\nimport { ActionSheetTheme, show } from './show';\nimport props from './props';\n\nconst { prefix } = config;\nconst name = `${prefix}-action-sheet`;\n\n@wxComponent()\nexport default class ActionSheet extends SuperComponent {\n  static show = show;\n\n  externalClasses = [`${prefix}-class`, `${prefix}-class-content`, `${prefix}-class-cancel`];\n\n  properties = {\n    ...props,\n  };\n\n  data = {\n    prefix,\n    classPrefix: name,\n    gridThemeItems: [],\n    currentSwiperIndex: 0,\n  };\n\n  controlledProps = [\n    {\n      key: 'visible',\n      event: 'visible-change',\n    },\n  ];\n\n  ready() {\n    this.memoInitialData();\n    this.splitGridThemeActions();\n  }\n\n  methods = {\n    onSwiperChange(e: WechatMiniprogram.TouchEvent) {\n      const {\n        detail: { current },\n      } = e;\n      this.setData({\n        currentSwiperIndex: current,\n      });\n    },\n\n    splitGridThemeActions() {\n      if (this.data.theme !== ActionSheetTheme.Grid) return;\n      this.setData({\n        gridThemeItems: chunk(this.data.items, this.data.count),\n      });\n    },\n\n    /** 指令调用显示 */\n    show(options) {\n      this.setData({\n        ...this.initialData,\n        ...options,\n        visible: true,\n      });\n      this.splitGridThemeActions();\n      this.autoClose = true;\n      this._trigger('visible-change', { visible: true });\n    },\n\n    memoInitialData() {\n      this.initialData = {\n        ...this.properties,\n        ...this.data,\n      };\n    },\n\n    /** 指令调用隐藏 */\n    close() {\n      this._trigger('visible-change', { visible: false });\n    },\n\n    /** 默认点击遮罩关闭 */\n    onPopupVisibleChange({ detail }) {\n      if (!detail.visible) {\n        this._trigger('visible-change', { visible: false });\n      }\n      if (this.autoClose) {\n        this.setData({ visible: false });\n        this.autoClose = false;\n      }\n    },\n\n    onSelect(event: WechatMiniprogram.TouchEvent) {\n      const { currentSwiperIndex, items, gridThemeItems, count, theme } = this.data;\n      const { index } = event.currentTarget.dataset;\n      const isSwiperMode = theme === ActionSheetTheme.Grid;\n      const item = isSwiperMode ? gridThemeItems[currentSwiperIndex][index] : items[index];\n      const realIndex = isSwiperMode ? index + currentSwiperIndex * count : index;\n      if (item) {\n        this.triggerEvent('selected', { selected: item, index: realIndex });\n        this._trigger('visible-change', { visible: false });\n      }\n    },\n\n    onCancel() {\n      this.triggerEvent('cancel');\n    },\n  };\n}\n"]}